<div class="flex flex-col items-center justify-between w-1/6 h-full p-4 bg-gray-100">
  <!-- Carré bleu au-dessus des barres -->
  <div class="w-full flex flex-col items-center justify-around space-y-4">
    <!-- Input pour le nom du groupe -->
    <input type="text" [(ngModel)]="name" (keydown.enter)="addGroup(); name=''" placeholder="Nom du groupe" class="w-full border border-gray-300 rounded-lg p-2 shadow-md focus:outline-none focus:ring focus:ring-blue-400">

    <!-- Bouton "Créer un groupe" -->
    <button (click)="addGroup(); name=''" class="w-full text-center py-2 border border-blue-700 text-blue-700 rounded-lg bg-white hover:bg-blue-700 hover:text-white transition duration-300 ease-in-out shadow-md">
      Créer un groupe
    </button>

    <!-- Input pour trouver un utilisateur -->
    <input type="text" [(ngModel)]="toConv" (keydown.enter)="addConv(); toAdd=''" placeholder="Trouver un utilisateur" class="w-full border border-gray-300 rounded-lg p-2 shadow-md focus:outline-none focus:ring focus:ring-blue-400">

    <!-- Bouton "Trouver un utilisateur" -->
    <button (click)="addConv(); toAdd=''" class="w-full text-center py-2 border border-blue-700 text-blue-700 rounded-lg bg-white hover:bg-blue-700 hover:text-white transition duration-300 ease-in-out shadow-md">
      Trouver un utilisateur
    </button>
  </div>

  <!-- Barre latérale pour les groupes et les conversations -->
  <div class="w-3/4 h-full bg-gray-800 p-4 rounded-lg shadow-lg mt-4">
    <h3 class="text-white text-lg font-semibold">Mes Groupes</h3>
    <div class="flex flex-col space-y-2 mt-2">
      <button *ngFor="let group of userGroups" (click)="changeGroup(group.name)" class="bg-blue-600 text-white rounded-lg py-2 hover:bg-blue-700 shadow-md transition duration-200">
        {{ group.name }}
      </button>
    </div>

    <h3 class="text-white text-lg font-semibold mt-4">Mes Conv</h3>
    <div class="flex flex-col space-y-2 mt-2">
      <button *ngFor="let conv of userConv" (click)="changeGroup(conv.name)" class="bg-green-600 text-white rounded-lg py-2 hover:bg-green-700 shadow-md transition duration-200">
        {{ conv.name }}
      </button>
    </div>
    {{group}}
    {{members}}

    <!-- Input pour ajouter un utilisateur -->
    <input type="text" [(ngModel)]="toAdd" (keydown.enter)="addInGroup(); toAdd=''" placeholder="Ajouter un utilisateur" class="mt-4 w-full border border-gray-300 rounded-lg p-2 shadow-md focus:outline-none focus:ring focus:ring-blue-400">

    <!-- Bouton "Ajouter un utilisateur" -->
    <button (click)="addInGroup(); toAdd=''" class="mt-2 w-full text-center py-2 border border-blue-700 text-blue-700 rounded-lg bg-white hover:bg-blue-700 hover:text-white transition duration-300 ease-in-out shadow-md">
      Ajouter un utilisateur
    </button>

    <!-- Input pour enlever un utilisateur -->
    <input type="text" [(ngModel)]="toRemove" (keydown.enter)="removeInGroup(); toRemove=''" placeholder="Enlever un utilisateur" class="mt-4 w-full border border-gray-300 rounded-lg p-2 shadow-md focus:outline-none focus:ring focus:ring-blue-400">

    <!-- Bouton "Enlever un utilisateur" -->
    <button (click)="removeInGroup(); toRemove=''" class="mt-2 w-full text-center py-2 border border-red-700 text-red-700 rounded-lg bg-white hover:bg-red-700 hover:text-white transition duration-300 ease-in-out shadow-md">
      Enlever un utilisateur
    </button>
    <button (click)="removeGroup();" class="mt-2 w-full text-center py-2 border border-red-700 text-red-700 rounded-lg bg-white hover:bg-red-700 hover:text-white transition duration-300 ease-in-out shadow-md">
      Enlever un groupe
    </button>
  </div>
</div>

<!-- Contenu principal -->
<div class="w-5/6 h-full bg-amber-900 relative">
  <!-- Bouton de déconnexion -->
  <button (click)="signOut()" class="absolute top-4 right-4 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition duration-300 shadow-md">
    Déconnexion
  </button>

  <!-- Conteneur de chat -->
  <div class="mt-8 mb-4 p-4 bg-white h-[calc(100vh-200px)] overflow-y-auto rounded-lg shadow-lg" id="chat-container">
    <!-- Messages du chat -->
    <div class="messages flex flex-col space-y-2">
      <div *ngFor="let message of messages" [ngClass]="{'my-message': message.user === pseudo, 'other-message': message.user !== pseudo}">
        <div class="font-semibold">{{ message.user }}</div>
        <div class="message mb-1">{{ message.text }}</div>
        <div *ngIf="message.fileUrl">
          <ng-container *ngIf="isImageFile(message.fileUrl); else mediaFile">
            <img [src]="message.fileUrl" alt="Image" class="max-w-full h-auto rounded-lg shadow-md">
          </ng-container>
          <ng-template #mediaFile>
            <ng-container *ngIf="isVideoFile(message.fileUrl); else audioFile">
              <video [src]="message.fileUrl" controls class="max-w-full h-auto rounded-lg shadow-md"></video>
            </ng-container>
            <ng-template #audioFile>
              <ng-container *ngIf="isAudioFile(message.fileUrl); else fileLink">
                <audio [src]="message.fileUrl" controls class="max-w-full h-auto rounded-lg shadow-md"></audio>
              </ng-container>
              <ng-template #fileLink>
                <a [href]="message.fileUrl" target="_blank" class="text-blue-600 underline">View File</a>
              </ng-template>
            </ng-template>
          </ng-template>
        </div>
      </div>
    </div>
  </div>

  <div class="fixed bottom-0 right-0 w-5/6 bg-white p-4 flex items-center justify-between rounded-lg shadow-lg">
    <!-- Zone d'entrée de texte -->
    <input type="text" [(ngModel)]="message" (keydown.enter)="sendMessage(); message=''" placeholder="Écrivez un message..." class="w-full bg-gray-100 border border-gray-300 rounded-lg p-2 mr-4 shadow-md focus:outline-none focus:ring focus:ring-blue-400">

    <!-- Options pour ajouter des fichiers et envoyer un message -->
    <div class="flex items-center space-x-4">
      <!-- Logo pour envoyer des images -->
      <button class="bg-gray-200 hover:bg-gray-300 p-2 rounded-lg" (click)="fileInput.click()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 000 2.828l1.414 1.414a2 2 0 002.828 0L20 12m0 0L15.172 7M20 12l-5.172-5.172m0 0L4 16m0 0l6.586 6.586a2 2 0 002.828 0L20 12" />
        </svg>
      </button>
      <input type="file" class="hidden" (change)="onFileSelected($event)" #fileInput>

      <!-- Bouton envoyer -->
      <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg shadow-md" (click)="sendMessage(); message=''">Envoyer</button>
    </div>
  </div>
</div>
